---
categories: [Excel]
---
<html>
<head>
  <title>Excel VBA</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307881 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="541"/>

<div>
<span><div><div><span style="font-size: 12pt; font-weight: bold;">Excel VBA Code: </span></div><div><font style="font-size: 8pt;"><br/></font></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">ListToTabs</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub ListToTabs()</font></div><div><font style="font-size: 8pt;">'Copies agents over to correct Sup Sheet</font></div><div><font style="font-size: 8pt;">Dim test As String</font></div><div><font style="font-size: 8pt;">With Ws_Audit</font></div><div><font style="font-size: 8pt;">Ws_Audit.Select</font></div><div><font style="font-size: 8pt;">For Each Tcell In Ws_Audit.Range(&quot;A2&quot;, Range(&quot;A&quot; &amp; Rows.Count).End(xlUp))</font></div><div><font style="font-size: 8pt;">test = Tcell.Offset(0, 2).Value</font></div><div><font style="font-size: 8pt;">Tcell.EntireRow.Copy</font></div><div><font style="font-size: 8pt;">Sheets(&quot;&quot; &amp; test &amp; &quot;&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;">End With</font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub AddBlankRowtoList()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub AddBlankRowtoList()</font></div><div><font style="font-size: 8pt;">Dim cell As Range</font></div><div><font style="font-size: 8pt;">Dim ColNum As String</font></div><div><font style="font-size: 8pt;">ColNum = InputBox(&quot;What Column?&quot;, &quot;Column&quot;)</font></div><div><font style="font-size: 8pt;">For I = Cells(Rows.Count, ColNum).End(xlUp).Row To 2 Step -1</font></div><div><font style="font-size: 8pt;">If Not Cells(I, ColNum).Value = &quot;&quot; Then</font></div><div><font style="font-size: 8pt;">Cells(I, ColNum).EntireRow.Insert Shift:=xlUp</font></div><div><font style="font-size: 8pt;">End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub FiscalDates()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub FiscalDates()</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Dim MyworkSheet As Worksheet</font></div><div><font style="font-size: 8pt;">Dim MainBook, SecondBook As Workbook</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Set MyworkSheet = ActiveSheet</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Set MainBook = ActiveWorkbook</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    Sheets.Add After:=Sheets(Sheets.Count)</font></div><div><font style="font-size: 8pt;">    </font></div><div><font style="font-size: 8pt;">     Workbooks.Open Filename:= _</font></div><div><font style="font-size: 8pt;">        &quot;\\ent.core.medtronic.com\mit-sat01\SAT Public\WFM\Tyger\FiscalDatesVlookup.xlsx&quot;</font></div><div><font style="font-size: 8pt;">    </font></div><div><font style="font-size: 8pt;">    Windows(&quot;FiscalDatesVlookup.xlsx&quot;).Activate</font></div><div><font style="font-size: 8pt;">    Set SecondBook = ThisWorkbook</font></div><div><font style="font-size: 8pt;">    Range(&quot;A1&quot;).Select</font></div><div><font style="font-size: 8pt;">    Range(Selection, Selection.End(xlToRight)).Select</font></div><div><font style="font-size: 8pt;">    Range(Selection, Selection.End(xlDown)).Select</font></div><div><font style="font-size: 8pt;">    Selection.Copy</font></div><div><font style="font-size: 8pt;">    MainBook.Activate</font></div><div><font style="font-size: 8pt;">    ActiveSheet.Paste</font></div><div><font style="font-size: 8pt;">    ActiveSheet.Name = &quot;FiscalLookupTempSheet&quot;</font></div><div><font style="font-size: 8pt;">    </font></div><div><font style="font-size: 8pt;">      Windows(&quot;FiscalDatesVlookup.xlsx&quot;).Activate</font></div><div><font style="font-size: 8pt;">      </font></div><div><font style="font-size: 8pt;">      Application.DisplayAlerts = False</font></div><div><font style="font-size: 8pt;">      ActiveWindow.Close</font></div><div><font style="font-size: 8pt;">   Application.DisplayAlerts = True</font></div><div><font style="font-size: 8pt;">   </font></div><div><font style="font-size: 8pt;">    MainBook.Activate</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyworkSheet.Select</font></div><div><font style="font-size: 8pt;">Set MyYearColumn = Application.InputBox(&quot;Select a Starting Cell for Year&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">YearR = MyYearColumn.Row</font></div><div><font style="font-size: 8pt;">YearC = MyYearColumn.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyworkSheet.Select</font></div><div><font style="font-size: 8pt;">Set MyQuarterColumn = Application.InputBox(&quot;Select a Starting Cell for Quarter&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">QuarterR = MyQuarterColumn.Row</font></div><div><font style="font-size: 8pt;">QuarterC = MyQuarterColumn.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyworkSheet.Select</font></div><div><font style="font-size: 8pt;">Set MyMonthColumn = Application.InputBox(&quot;Select a Starting Cell for Month&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">MonthR = MyMonthColumn.Row</font></div><div><font style="font-size: 8pt;">MonthC = MyMonthColumn.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyworkSheet.Select</font></div><div><font style="font-size: 8pt;">Set MyWeekColumn = Application.InputBox(&quot;Select a Starting Cell for Week&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">WeekR = MyWeekColumn.Row</font></div><div><font style="font-size: 8pt;">WeekC = MyWeekColumn.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyworkSheet.Select</font></div><div><font style="font-size: 8pt;">MyCellsStartingRow = WeekR</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyworkSheet.Select</font></div><div><font style="font-size: 8pt;">Set LookUpValue = Application.InputBox(&quot;Select a LookUp Value&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">LookUpValueR = LookUpValue.Row</font></div><div><font style="font-size: 8pt;">LookUpValueC = LookUpValue.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.ScreenUpdating = False</font></div><div><font style="font-size: 8pt;">Application.Calculation = xlCalculationManual</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">LastRow = Cells(Rows.Count, LookUpValueC).End(xlUp).Row</font></div><div><font style="font-size: 8pt;">FirstRow = YearR</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyStartTime = Now</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For I = FirstRow To LastRow</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">'TimePassing = Now - MyStartTime</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.StatusBar = I &amp; &quot; out of &quot; &amp; LastRow &amp; &quot; &quot; '&amp; Format(TimePassing, &quot;hh:MM:SS&quot;)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Cells(MyCellsStartingRow, YearC).Value = Application.WorksheetFunction.VLookup(Cells(LookUpValueR, LookUpValueC), Sheets(&quot;FiscalLookupTempSheet&quot;).Range(&quot;A:Q&quot;), 5, False)</font></div><div><font style="font-size: 8pt;">Cells(MyCellsStartingRow, QuarterC).Value = Application.WorksheetFunction.VLookup(Cells(LookUpValueR, LookUpValueC), Sheets(&quot;FiscalLookupTempSheet&quot;).Range(&quot;A:Q&quot;), 6, False)</font></div><div><font style="font-size: 8pt;">Cells(MyCellsStartingRow, MonthC).Value = Application.WorksheetFunction.VLookup(Cells(LookUpValueR, LookUpValueC), Sheets(&quot;FiscalLookupTempSheet&quot;).Range(&quot;A:Q&quot;), 7, False)</font></div><div><font style="font-size: 8pt;">Cells(MyCellsStartingRow, WeekC).Value = Application.WorksheetFunction.VLookup(Cells(LookUpValueR, LookUpValueC), Sheets(&quot;FiscalLookupTempSheet&quot;).Range(&quot;A:Q&quot;), 8, False)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">YearR = YearR + 1</font></div><div><font style="font-size: 8pt;">QuarterR = QuarterR + 1</font></div><div><font style="font-size: 8pt;">MonthR = MonthR + 1</font></div><div><font style="font-size: 8pt;">WeekR = WeekR + 1</font></div><div><font style="font-size: 8pt;">LookUpValueR = LookUpValueR + 1</font></div><div><font style="font-size: 8pt;">MyCellsStartingRow = MyCellsStartingRow + 1</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;">Cells(1, YearC).Value = &quot;Year&quot;</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Cells(1, QuarterC).Value = &quot;Quarter&quot;</font></div><div><font style="font-size: 8pt;">Cells(1, MonthC).Value = &quot;Month&quot;</font></div><div><font style="font-size: 8pt;">Cells(1, WeekC).Value = &quot;Week&quot;</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.DisplayAlerts = False</font></div><div><font style="font-size: 8pt;">Sheets(&quot;FiscalLookupTempSheet&quot;).Delete</font></div><div><font style="font-size: 8pt;">Application.DisplayAlerts = True</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.ScreenUpdating = True</font></div><div><font style="font-size: 8pt;">Application.Calculation = xlCalculationAutomatic</font></div><div><font style="font-size: 8pt;">Application.StatusBar = &quot;&quot;</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div><div><font style="font-size: 8pt;"><br/></font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub DateandTimeBreaker()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub DateandTimeBreaker()</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Set MyDate = Application.InputBox(&quot;Select a Starting Cell for Dates&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">DateRow = MyDate.Row</font></div><div><font style="font-size: 8pt;">DateCol = MyDate.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Set MyTime = Application.InputBox(&quot;Select a Starting Cell for Time&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">TimeRow = MyTime.Row</font></div><div><font style="font-size: 8pt;">TimeCol = MyTime.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Set LookUpValue = Application.InputBox(&quot;Select a LookUpCell&quot;, &quot;Choose Cell&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">LookupValueRow = LookUpValue.Row</font></div><div><font style="font-size: 8pt;">LookUpValueCol = LookUpValue.Column</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">If TimeRow = 1 Then</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MsgBox (&quot;Please Add Header Row and Try Again&quot;)</font></div><div><font style="font-size: 8pt;">Exit Sub</font></div><div><font style="font-size: 8pt;">End If</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">LastRow = Cells(Rows.Count, LookUpValueCol).End(xlUp).Row</font></div><div><font style="font-size: 8pt;">FirstRow = LookupValueRow</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.Calculation = xlCalculationManual</font></div><div><font style="font-size: 8pt;">Application.ScreenUpdating = False</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For I = FirstRow To LastRow</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Cells(DateRow, DateCol).Value = DateValue(Application.WorksheetFunction.Text(Cells(LookupValueRow, LookUpValueCol), &quot;MM/DD/YYYY&quot;))</font></div><div><font style="font-size: 8pt;">Cells(TimeRow, TimeCol).Value = TimeValue(Application.WorksheetFunction.Text(Cells(LookupValueRow, LookUpValueCol), &quot;HH:MM AM/PM&quot;))</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">DateRow = DateRow + 1</font></div><div><font style="font-size: 8pt;">TimeRow = TimeRow + 1</font></div><div><font style="font-size: 8pt;">LookupValueRow = LookupValueRow + 1</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.StatusBar = DateRow &amp; &quot; of &quot; &amp; LastRow</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Cells(1, DateCol).Value = &quot;Date&quot;</font></div><div><font style="font-size: 8pt;">Cells(1, TimeCol).Value = &quot;Time&quot;</font></div><div><font style="font-size: 8pt;">Application.StatusBar = &quot;&quot;</font></div><div><font style="font-size: 8pt;">Application.Calculation = xlCalculationAutomatic</font></div><div><font style="font-size: 8pt;">Application.ScreenUpdating = True</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub FindandHighlight()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub FindandHighlight()</font></div><div><font style="font-size: 8pt;">Dim I, t As Integer</font></div><div><font style="font-size: 8pt;">Dim MyCol, MySearch As String</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">MyCol = InputBox(&quot;What Column&quot;, &quot;Column&quot;)</font></div><div><font style="font-size: 8pt;">MySearch = InputBox(&quot;Search Term:&quot;, &quot;Search&quot;)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For I = Cells(Rows.Count, MyCol).End(xlUp).Row To 2 Step -1</font></div><div><font style="font-size: 8pt;">    t = InStr(1, Cells(I, MyCol).Value, MySearch, vbTextCompare)</font></div><div><font style="font-size: 8pt;">        If t &gt; 0 Then</font></div><div><font style="font-size: 8pt;">            Cells(I, MyCol).Interior.Color = vbYellow</font></div><div><font style="font-size: 8pt;">        End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub Tenure()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub Tenure()</font></div><div><font style="font-size: 8pt;">ReturnType = InputBox(&quot;What format? YYYY or M or  D &quot;, &quot;Y for Year, M for Month , D for Day&quot;)</font></div><div><font style="font-size: 8pt;">OrgDate = Application.InputBox(&quot;Select a range&quot;, &quot;Choose Range&quot;, Type:=8)</font></div><div><font style="font-size: 8pt;">MyDate = DateDiff(ReturnType, OrgDate, Now())</font></div><div><font style="font-size: 8pt;">MsgBox (MyDate)</font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Function SwtichName(cell As Range)</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Function SwtichName(cell As Range)</font></div><div><font style="font-size: 8pt;">'Function Needed to Split Name</font></div><div><font style="font-size: 8pt;">Name = Split(Replace(cell.Text, Chr(160), &quot;&quot;), &quot;,&quot;)</font></div><div><font style="font-size: 8pt;">SwitchName = Trim(Name(1)) &amp; &quot; &quot; &amp; Trim(Name(0))</font></div><div><font style="font-size: 8pt;">End Function</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub SendSupsEmails()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub SendSupsEmails()</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    Dim rng As Range</font></div><div><font style="font-size: 8pt;">    Dim examples As Range</font></div><div><font style="font-size: 8pt;">    Dim OutApp As Object</font></div><div><font style="font-size: 8pt;">    Dim OutMail As Object</font></div><div><font style="font-size: 8pt;">    Dim strBody As String</font></div><div><font style="font-size: 8pt;">    Dim strBody1 As String</font></div><div><font style="font-size: 8pt;">    </font></div><div><font style="font-size: 8pt;">Const olImportanceHigh = 2</font></div><div><font style="font-size: 8pt;">    Set rng = Nothing</font></div><div><font style="font-size: 8pt;">    On Error Resume Next</font></div><div><font style="font-size: 8pt;">   </font></div><div><font style="font-size: 8pt;">   Call PrepEmailsheets</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">strBody = &quot;This Escalation is for &quot; &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot;</font></div><div><font style="font-size: 8pt;">strBody1 = &quot;We are doing our Bi-Weekly Aux 2 Audit. &quot; &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; _</font></div><div><font style="font-size: 8pt;">              &quot;Agents listed above have exceeded that threshold for date Range : &quot; &amp; _</font></div><div><font style="font-size: 8pt;">              wsMain.Range(&quot;Date_Start&quot;).Value &amp; &quot; - &quot; &amp; _</font></div><div><font style="font-size: 8pt;">              wsMain.Range(&quot;Date_End&quot;).Value &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; _</font></div><div><font style="font-size: 8pt;">              &quot;Agents are escalated 2.50% of their staffed time: &quot; &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; _</font></div><div><font style="font-size: 8pt;">              &quot;For Example: &quot;</font></div><div><font style="font-size: 8pt;">              </font></div><div><font style="font-size: 8pt;">              </font></div><div><font style="font-size: 8pt;">Set OutApp = CreateObject(&quot;Outlook.Application&quot;)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">wsSupList.Select</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Set examples = wsMain.Range(&quot;H2:I7&quot;)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For Each cell In wsSupList.Range(&quot;A2&quot;, Range(&quot;A&quot; &amp; Rows.Count).End(xlUp))</font></div><div><font style="font-size: 8pt;">Set rng = Sheets(&quot;&quot; &amp; cell.Value &amp; &quot;&quot;).UsedRange</font></div><div><font style="font-size: 8pt;">Set OutMail = OutApp.CreateItem(0)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    On Error Resume Next</font></div><div><font style="font-size: 8pt;">    With OutMail</font></div><div><font style="font-size: 8pt;">         .SentOnBehalfOfName = &quot;Care&lt;Care.e@company.com&gt;&quot;</font></div><div><font style="font-size: 8pt;">        .To = cell.Value</font></div><div><font style="font-size: 8pt;">        .CC = cell.Offset(0, 1).Value </font></div><div><font style="font-size: 8pt;">        .BCC = &quot;&quot;</font></div><div><font style="font-size: 8pt;">        .Subject = &quot;Email Subject&quot;</font></div><div><font style="font-size: 8pt;">          .Importance = olImportanceHigh</font></div><div><font style="font-size: 8pt;">        .HTMLBody = strBody &amp; RangetoHTML(rng) &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; strBody1 &amp; &quot;</font></div><div><font style="font-size: 8pt;">&quot; &amp; RangetoHTML(examples)</font></div><div><font style="font-size: 8pt;">        .Display    'or use .Display</font></div><div><font style="font-size: 8pt;">    End With</font></div><div><font style="font-size: 8pt;">    On Error GoTo 0</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    With Application</font></div><div><font style="font-size: 8pt;">        .EnableEvents = True</font></div><div><font style="font-size: 8pt;">        .ScreenUpdating = True</font></div><div><font style="font-size: 8pt;">    End With</font></div><div><font style="font-size: 8pt;">    </font></div><div><font style="font-size: 8pt;">    MSG1 = MsgBox(&quot;Do you wish to conintue?&quot;, vbYesNo, &quot;Sending Emails&quot;)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">If MSG1 = vbYes Then</font></div><div><font style="font-size: 8pt;">  ' nothing</font></div><div><font style="font-size: 8pt;">Else</font></div><div><font style="font-size: 8pt;">  Exit Sub</font></div><div><font style="font-size: 8pt;">End If</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Next cell</font></div><div><font style="font-size: 8pt;">Call Hidesups</font></div><div><font style="font-size: 8pt;">    Set OutMail = Nothing</font></div><div><font style="font-size: 8pt;">    Set OutApp = Nothing</font></div><div><font style="font-size: 8pt;">    wsEventLog.Select</font></div><div><font style="font-size: 8pt;">    </font></div><div><font style="font-size: 8pt;">End Sub</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Function RangetoHTML(rng As Range)</font></div><div><font style="font-size: 8pt;">' Changed by Ron de Bruin 28-Oct-2006</font></div><div><font style="font-size: 8pt;">' Working in Office 2000-2013</font></div><div><font style="font-size: 8pt;">    Dim fso As Object</font></div><div><font style="font-size: 8pt;">    Dim ts As Object</font></div><div><font style="font-size: 8pt;">    Dim TempFile As String</font></div><div><font style="font-size: 8pt;">    Dim TempWB As Workbook</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    TempFile = Environ$(&quot;temp&quot;) &amp; &quot;\&quot; &amp; Format(Now, &quot;dd-mm-yy h-mm-ss&quot;) &amp; &quot;.htm&quot;</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    'Copy the range and create a new workbook to past the data in</font></div><div><font style="font-size: 8pt;">    rng.Copy</font></div><div><font style="font-size: 8pt;">    Set TempWB = Workbooks.Add(1)</font></div><div><font style="font-size: 8pt;">    With TempWB.Sheets(1)</font></div><div><font style="font-size: 8pt;">        .Cells(1).PasteSpecial Paste:=8</font></div><div><font style="font-size: 8pt;">        .Cells(1).PasteSpecial xlPasteValues, , False, False</font></div><div><font style="font-size: 8pt;">        .Cells(1).PasteSpecial xlPasteFormats, , False, False</font></div><div><font style="font-size: 8pt;">        .Cells(1).Select</font></div><div><font style="font-size: 8pt;">        Application.CutCopyMode = False</font></div><div><font style="font-size: 8pt;">        On Error Resume Next</font></div><div><font style="font-size: 8pt;">        .DrawingObjects.Visible = True</font></div><div><font style="font-size: 8pt;">        .DrawingObjects.Delete</font></div><div><font style="font-size: 8pt;">        On Error GoTo 0</font></div><div><font style="font-size: 8pt;">    End With</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    'Publish the sheet to a htm file</font></div><div><font style="font-size: 8pt;">    With TempWB.PublishObjects.Add( _</font></div><div><font style="font-size: 8pt;">         SourceType:=xlSourceRange, _</font></div><div><font style="font-size: 8pt;">         Filename:=TempFile, _</font></div><div><font style="font-size: 8pt;">         Sheet:=TempWB.Sheets(1).Name, _</font></div><div><font style="font-size: 8pt;">         Source:=TempWB.Sheets(1).UsedRange.Address, _</font></div><div><font style="font-size: 8pt;">         HtmlType:=xlHtmlStatic)</font></div><div><font style="font-size: 8pt;">        .Publish (True)</font></div><div><font style="font-size: 8pt;">    End With</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    'Read all data from the htm file into RangetoHTML</font></div><div><font style="font-size: 8pt;">    Set fso = CreateObject(&quot;Scripting.FileSystemObject&quot;)</font></div><div><font style="font-size: 8pt;">    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)</font></div><div><font style="font-size: 8pt;">    RangetoHTML = ts.ReadAll</font></div><div><font style="font-size: 8pt;">    ts.Close</font></div><div><font style="font-size: 8pt;">    RangetoHTML = Replace(RangetoHTML, &quot;align=center x:publishsource=&quot;, _</font></div><div><font style="font-size: 8pt;">                          &quot;align=left x:publishsource=&quot;)</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    'Close TempWB</font></div><div><font style="font-size: 8pt;">    TempWB.Close savechanges:=False</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    'Delete the htm file we used in this function</font></div><div><font style="font-size: 8pt;">    Kill TempFile</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">    Set ts = Nothing</font></div><div><font style="font-size: 8pt;">    Set fso = Nothing</font></div><div><font style="font-size: 8pt;">    Set TempWB = Nothing</font></div><div><font style="font-size: 8pt;">End Function</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub MoveHighlighted()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub MoveHighlighted()</font></div><div><font style="font-size: 8pt;">Dim cell As Range</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For Each cell In Sheet6.Range(&quot;A2&quot;, Range(&quot;A&quot; &amp; Rows.Count).End(xlUp))</font></div><div><font style="font-size: 8pt;">If cell.Interior.Color = vbRed Then</font></div><div><font style="font-size: 8pt;">cell.Copy</font></div><div><font style="font-size: 8pt;">Sheet6.Range(&quot;L&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial</font></div><div><font style="font-size: 8pt;">End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For Each cell In Sheet6.Range(&quot;G2&quot;, Range(&quot;G&quot; &amp; Rows.Count).End(xlUp))</font></div><div><font style="font-size: 8pt;">If cell.Interior.Color = vbRed Then</font></div><div><font style="font-size: 8pt;">cell.Copy</font></div><div><font style="font-size: 8pt;">Sheet6.Range(&quot;L&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).PasteSpecial</font></div><div><font style="font-size: 8pt;">End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div><div><font style="font-size: 8pt;"><br/></font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub RemoveRowIFString()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub RemoveRowIFString()</font></div><div><font style="font-size: 8pt;">Dim I As Integer</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">For I = Sheet9.Cells(Rows.Count, &quot;F&quot;).End(xlUp).Row To 2 Step -1</font></div><div><font style="font-size: 8pt;">    t = InStr(1, Cells(I, &quot;F&quot;).Value, &quot;Training&quot;, vbTextCompare)</font></div><div><font style="font-size: 8pt;">        If InStr(1, Cells(I, &quot;F&quot;).Value, &quot;Training&quot;, vbTextCompare) &gt; 0 Then</font></div><div><font style="font-size: 8pt;">            Sheet9.Cells(I, &quot;F&quot;).EntireRow.Delete</font></div><div><font style="font-size: 8pt;">        End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Sub DeleteObj()</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub DeleteObj()</font></div><div><font style="font-size: 8pt;">Application.StatusBar = &quot; Deleteing Objects&quot;</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Dim Obj As Object</font></div><div><font style="font-size: 8pt;">    For Each Obj In ActiveSheet.Shapes ' Deletes all object on selected page</font></div><div><font style="font-size: 8pt;">    Obj.Delete</font></div><div><font style="font-size: 8pt;">    Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">Application.StatusBar = &quot;&quot;</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">Shade Every Other Row</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub ShadeEveryOtherRow()</font></div><div><font style="font-size: 8pt;">Dim Counter As Integer</font></div><div><font style="font-size: 8pt;">Dim rng As Range</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">On Error GoTo ErrHandler 'Exits if Error</font></div><div><font style="font-size: 8pt;">Set rng = Application.InputBox(&quot;Select a range&quot;, &quot;Choose Range&quot;, Type:=8) 'Pop Up To Select Range</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">'Highlights Every Other Row Grey</font></div><div><font style="font-size: 8pt;">For Counter = 1 To rng.Rows.Count</font></div><div><font style="font-size: 8pt;">    'If the row is an odd number it highlights it Grey</font></div><div><font style="font-size: 8pt;">    If Counter Mod 2 = 1 Then</font></div><div><font style="font-size: 8pt;">        With rng.Rows(Counter).Interior</font></div><div><font style="font-size: 8pt;">            .PatternColorIndex = xlAutomatic</font></div><div><font style="font-size: 8pt;">            .ThemeColor = xlThemeColorDark1</font></div><div><font style="font-size: 8pt;">            .TintAndShade = -0.149998474074526</font></div><div><font style="font-size: 8pt;">            .PatternTintAndShade = 0</font></div><div><font style="font-size: 8pt;">        End With</font></div><div><font style="font-size: 8pt;">    End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">'Adds Borders</font></div><div><font style="font-size: 8pt;">rng.Borders(xlEdgeLeft).LineStyle = xlContinuous</font></div><div><font style="font-size: 8pt;">rng.Borders(xlEdgeLeft).Weight = xlThin</font></div><div><font style="font-size: 8pt;">    rng.Borders(xlEdgeTop).LineStyle = xlContinuous</font></div><div><font style="font-size: 8pt;">    rng.Borders(xlEdgeTop).Weight = xlThin</font></div><div><font style="font-size: 8pt;">        rng.Borders(xlEdgeBottom).LineStyle = xlContinuous</font></div><div><font style="font-size: 8pt;">        rng.Borders(xlEdgeBottom).Weight = xlThin</font></div><div><font style="font-size: 8pt;">            rng.Borders(xlEdgeRight).LineStyle = xlContinuous</font></div><div><font style="font-size: 8pt;">            rng.Borders(xlEdgeRight).Weight = xlThin</font></div><div><font style="font-size: 8pt;">                rng.Borders(xlInsideVertical).LineStyle = xlContinuous</font></div><div><font style="font-size: 8pt;">                rng.Borders(xlInsideVertical).Weight = xlThin</font></div><div><font style="font-size: 8pt;">                    rng.Borders(xlInsideHorizontal).LineStyle = xlContinuous</font></div><div><font style="font-size: 8pt;">                    rng.Borders(xlInsideHorizontal).Weight = xlThin</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">ErrHandler: Exit Sub</font></div><div><font style="font-size: 8pt;"><br/></font></div><div><font style="font-size: 8pt;">End Sub</font></div><div><font style="font-size: 8pt;"><br/></font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">5 digit Number Extract</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Function FiveDigitNo(s As String)</font></div><div><font style="font-size: 8pt;">With CreateObject(&quot;vbscript.regexp&quot;)</font></div><div><font style="font-size: 8pt;">  .Pattern = &quot;\b\d{5}\b&quot;</font></div><div><font style="font-size: 8pt;">  If .Test(s) Then FiveDigitNo = .Execute(s)(0)</font></div><div><font style="font-size: 8pt;">End With</font></div><div><font style="font-size: 8pt;">End Function</font></div></div><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1><span style="font-size: 8pt;">BuildandRemoveList</span></h1></td></tr></tbody></table><div><br/></div></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><font style="font-size: 8pt;">Sub BuildandRemove()</font></div><div><font style="font-size: 8pt;">Set List = CreateObject(&quot;Scripting.Dictionary&quot;)</font></div><div><font style="font-size: 8pt;">'Adds Agent Id's From Hierachy To List</font></div><div><font style="font-size: 8pt;">With wsHierarchy</font></div><div><font style="font-size: 8pt;">wsHierarchy.Select</font></div><div><font style="font-size: 8pt;">    For Each rng In wsHierarchy.Range(&quot;B1&quot;, Range(&quot;B&quot; &amp; Rows.Count).End(xlUp))</font></div><div><font style="font-size: 8pt;">     If Not List.Exists(rng.Value) Then</font></div><div><font style="font-size: 8pt;">        List.Add rng.Value, Nothing</font></div><div><font style="font-size: 8pt;">        End If</font></div><div><font style="font-size: 8pt;">     Next</font></div><div><font style="font-size: 8pt;">End With</font></div><div><font style="font-size: 8pt;">'Checks Agents in Audit vs List and Removes if not in list</font></div><div><font style="font-size: 8pt;">With wsAudit</font></div><div><font style="font-size: 8pt;">wsAudit.Select</font></div><div><font style="font-size: 8pt;">For rw = wsAudit.Cells(Rows.Count, &quot;B&quot;).End(xlUp).Row To 4 Step -1</font></div><div><font style="font-size: 8pt;">    If Not List.Exists(.Cells(rw, &quot;B&quot;).Value) Then</font></div><div><font style="font-size: 8pt;">        .Rows(rw).Delete</font></div><div><font style="font-size: 8pt;">     End If</font></div><div><font style="font-size: 8pt;">Next</font></div><div><font style="font-size: 8pt;">    End With</font></div><div><font style="font-size: 8pt;">    Set List = Nothing</font></div><div><font style="font-size: 8pt;">End Sub</font></div></div><div><font style="font-size: 8pt;"><br/></font></div><div><br/></div></span>
</div></body></html>
