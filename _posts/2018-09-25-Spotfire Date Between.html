---
categories: [Spotfire]
---
<html>
<head>
  <title>Date is Between Expression</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307881 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="537"/>

<div>
<span><div><div><div><b>Problem: </b></div><div><b>   </b> With a list of Start and End Times calculate how many people and how many hours in total by day/hour accounting for the day boundary. <br/></div><div><br/></div><div><b>Solution: </b></div><div><b>   </b> Label the Cross day boundaries, Make a Duplicate Table with only the cross day boundaries. Run the following Equations on both tables.  (On the Cross Day Table calculate and replace the start date with the end date for calculations to work) Combine the two tables.  <br/></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 69px;"></col><col style="width: 143px;"></col><col style="width: 150px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 69px; padding: 8px;"><div>Person</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 143px; padding: 8px;"><div>StartTime</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 150px; padding: 8px;"><div>EndTime</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 69px; padding: 8px;"><div>1</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 143px; padding: 8px;"><div>01/01/1999 8:30 AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 150px; padding: 8px;"><div>01/01/1999 10:00 AM</div></td></tr></tbody></table><div><div><br/></div><br/></div><div><div>Calculate if During Present During Hour</div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 61px;"></col><col style="width: 80px;"></col><col style="width: 48px;"></col><col style="width: 48px;"></col><col style="width: 48px;"></col><col style="width: 52px;"></col><col style="width: 52px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 61px; padding: 8px;"><div>Person</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 80px; padding: 8px;"><div>Date</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>7AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>8AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>9AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>10AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>11AM</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 61px; padding: 8px;"><div>1</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 80px; padding: 8px;"><div>01.01.1999</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>False</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>True</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>True</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>True</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>False</div></td></tr></tbody></table><div>Calculate Time </div></div></div><table style="border-collapse: collapse; min-width: 100%;"><colgroup><col style="width: 61px;"></col><col style="width: 80px;"></col><col style="width: 48px;"></col><col style="width: 48px;"></col><col style="width: 48px;"></col><col style="width: 52px;"></col><col style="width: 52px;"></col></colgroup><tbody><tr><td style="border: 1px solid rgb(204, 204, 204); width: 61px; padding: 8px;"><div>Person</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 80px; padding: 8px;"><div>Date</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>7AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>8AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>9AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>10AM</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>11AM</div></td></tr><tr><td style="border: 1px solid rgb(204, 204, 204); width: 61px; padding: 8px;"><div>1</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 80px; padding: 8px;"><div>01.01.1999</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>0</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>1800</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 48px; padding: 8px;"><div>3600</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>3600</div></td><td style="border: 1px solid rgb(204, 204, 204); width: 52px; padding: 8px;"><div>0</div></td></tr></tbody></table><div><br/></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>12A</div><div>case  </div><div>when (DateTime([Shift Start])&lt;=DateTime(Year([Local Day]),Month([Local Day]),Day([Local Day]),0,0,0,0))</div><div>and (DateTime([Shift End])&gt;=DateTime(Year([Local Day]),Month([Local Day]),Day([Local Day]),0,59,59,0)) then True</div><div>when (Hour([Shift End])=0) and (Minute([Shift End])&gt;0) and (Date([Local Day])=Date([Shift End])) then True</div><div>when (Hour([Shift Start])=0) and (Date([Local Day])=Date([Shift Start])) then True</div><div>else False</div><div>end</div></div><div><br/></div><div>Calculate Hours</div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>(if([12A]=True,case  </div><div>when (Date([Local Day])=Date([Shift Start])) and (Hour([Shift Start])=0) and (Minute([Shift Start])&gt;0) then</div><div>      DateDiff(&quot;ss&quot;,[Shift Start],DateTime(Year([Local Day]),Month([Local Day]),Day([Local Day]),0,0,0,0)) + 3600</div><div><br/></div><div>when DateDiff(&quot;ss&quot;,DateTime(Year([Local Day]),Month([Local Day]),Day([Local Day]),0,0,0,0),[Shift End])&gt;3600 then</div><div>     3600</div><div>else</div></div><div><br/></div><div><br/></div><div>For day boundary consider making a duplicate sheet with cross days only info. </div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>a[a==''] &lt;- NA</div><div>tempTable &lt;-a[which(a[,1]&gt;0),]</div><div>d&lt;-tempTable</div><div><br/></div><div>b &lt;- rbind(tempTable,c)</div></div><div><br/></div></div></span>
</div></body></html>
