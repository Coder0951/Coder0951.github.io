---
categories: [Spotfire]
---
<html>
<head>
  <title>Spotfire Expressions</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307881 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="549"/>

<div>
<span><div><div><br/></div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1>MovingTotal</h1></td></tr></tbody></table><div><span style="font-weight: bold;">Problem:</span><br/></div></div><div>    How to use Over Intersect Expression with Two variables to view a moving total.</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><br/></div><div>TimeSpan(0,Integer(Floor(Sum([AnswerWaitTimeSeconds])</div><div>OVER (Intersect([Date],AllPrevious([Axis.Columns]))) / Sum([CallsAnswered])</div><div>OVER (Intersect([Date],AllPrevious([Axis.Columns]))) / 3600)),Integer(Floor(Mod(Sum([AnswerWaitTimeSeconds])</div><div>OVER (Intersect([Date],AllPrevious([Axis.Columns]))) / Sum([CallsAnswered])</div><div>OVER (Intersect([Date],AllPrevious([Axis.Columns]))),3600) / 60)),Integer(Mod(Mod(Sum([AnswerWaitTimeSeconds])</div><div>OVER (Intersect([Date],AllPrevious([Axis.Columns]))) / Sum([CallsAnswered])</div><div>OVER (Intersect([Date],AllPrevious([Axis.Columns]))),3600),60)),0) as [Moving AWT],</div><div><br/></div><div>Time(TimeSpan(0,Integer(Floor(Sum([AnswerWaitTimeSeconds]) / Sum([CallsAnswered]) / 3600)),Integer(Floor(Mod(Sum([AnswerWaitTimeSeconds]) / Sum([CallsAnswered]),3600) / 60)),Integer(Mod(Mod(Sum([AnswerWaitTimeSeconds]) / Sum([CallsAnswered]),3600),60)),0)) as [AWT],</div><div><br/></div><div><br/></div><div>Sum([CallsOffered]) OVER (Intersect([Date],AllPrevious([Axis.Columns]))) as [Moving Calls Offered],</div><div>Sum([CallsOffered]) as [Offered],</div></div><div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1>CountIF</h1></td></tr></tbody></table><div><span style="font-weight: bold;">Problem:</span><br/></div></div><div>    How to use CountIF , SumIF ect in Spotfire.</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Count(IF [Column] = x , [Column], Null)) </div><div><br/></div><div>UniqueCount(IF [Column] = x , [Column], Null))</div><div><br/></div><div>Sum(IF [Column] = x , [Column], Null))</div></div><div><table bgcolor="#D4DDE5" border="0" width="100%"><colgroup><col></col></colgroup><tbody><tr><td><h1>HHMMSS</h1></td></tr></tbody></table><div><span style="font-weight: bold;">Problem:  </span><br/></div></div><div><span style="font-weight: bold;">   </span> Change integer into HH:MM:SS format. </div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>Time(0,Integer(Sum([HandleTime]) / Sum([CallsHandled]) / 60),Integer(((Sum([HandleTime]) / Sum([CallsHandled]) / 60) - Integer(Sum([HandleTime]) / Sum([CallsHandled]) / 60)) * 60),0)</div></div><div><br/></div><div><br/></div></span>
</div></body></html>
