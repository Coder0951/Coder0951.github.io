---
categories: [Python]
---
<html>
<head>
  <title>Emails</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307881 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="458"/>

<div>
<span><div><div><b>Problem:</b></div><div><b>   </b> <font style="font-size: 8pt;">Various Excel sheets need to be opened , have data refreshed , screen shot taken of a tab , and screen shot and file emailed via Outlook. </font><br/></div><div><font style="font-size: 8pt;"><br/></font></div><div><b>Solution: </b></div><div><b>   </b> <font style="font-size: 8pt;">Python program deployed on a Virtual Desktop with Task Scheduler set to run a .EXE version every hour. </font><br/></div><div><font style="font-size: 8pt;"><br/></font></div><hr/><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import win32com.client</div><div>import time</div><div>import win32process</div><div>import win32gui</div><div>import win32api</div><div>import win32con</div><div>import glob</div><div>from pywintypes import com_error</div><div>from datetime import datetime</div><div>from datetime import timedelta</div><div>import logging</div><div>from logging.handlers import RotatingFileHandler</div><div>import getpass</div><div>import os</div><div>import shutil</div><div>import pandas as pd</div><div>from PIL import ImageGrab</div><div><br/></div><div><br/></div><div># ############################## referenced in program ####################################</div><div>def mycountchecker(AttachmentFlag, excelpath, pname, start_time, fname, path, mycount, Range1, Range2, Range3, Range4, SheetToSend, EmailTo1, EmailTo2):</div><div>    mycount = mycount + 1</div><div>    if mycount &gt; 20:</div><div>        onErrorReplaceWorkBook(fname=fname, path=path,</div><div>                               pname=pname, excelpath=excelpath)</div><div>        logger.debug(&quot;Failed More Than Twice Ending Program - &quot; + pname)</div><div>        EndProgram()</div><div>    else:</div><div>        onErrorReplaceWorkBook(fname=fname, path=path,</div><div>                               pname=pname, excelpath=excelpath)</div><div>        logger.debug(&quot;Failed Replacing and Re-attempting - &quot; + pname)</div><div>        attemptToOpenSpreadSheet(</div><div>            AttachmentFlag=AttachmentFlag, pname=pname, start_time=start_time, fname=fname, path=path,</div><div>            mycount=mycount, Range1=Range1, Range2=Range2, Range3=Range3,</div><div>            Range4=Range4, SheetToSend=SheetToSend, EmailTo1=EmailTo1, EmailTo2=EmailTo2</div><div>        )</div><div><br/></div><div><br/></div><div>def close_excel_by_force(excel):</div><div>    try:</div><div>        #  Get the window's process id's</div><div>        hwnd = excel.Hwnd</div><div>        t,  p = win32process.GetWindowThreadProcessId(hwnd)</div><div>        #  Ask window nicely to close</div><div>        win32gui.PostMessage(hwnd,  win32con.WM_CLOSE,  0,  0)</div><div>        #  Allow some time for app to close</div><div>        time.sleep(10)</div><div>        #  If the application didn't close,  force close</div><div>    except Exception as e:</div><div>        pass</div><div>    try:</div><div>        handle = win32api.OpenProcess(win32con.PROCESS_TERMINATE,  0,  p)</div><div>        if handle:</div><div>            win32api.TerminateProcess(handle,  0)</div><div>            win32api.CloseHandle(handle)</div><div>    except Exception as e:</div><div>        pass</div><div><br/></div><div><br/></div><div>def savetempfileondesktop(fname, path, pname):</div><div>    logger.debug(&quot;Attempting to Save Back Up Files to Temp Location&quot;)</div><div>    try:</div><div>        mytempdirectory = &quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot;</div><div>        logger.debug('Temp Location - ' + mytempdirectory + &quot; - &quot; + pname)</div><div>        if not os.path.exists(mytempdirectory):</div><div>            os.makedirs(mytempdirectory)</div><div>            # time.sleep(1)</div><div>        shutil.copy2(fname, mytempdirectory)  # Copy to Temp Folder</div><div>        logger.debug(&quot;BackUp Filed Saved On Desktop - &quot; + pname)</div><div>    except Exception as e:</div><div>        logger.debug(e)</div><div><br/></div><div>        # ############################## start of program ####################################</div><div><br/></div><div><br/></div><div>def onErrorReplaceWorkBook(fname, path, pname, excelpath):</div><div>    # logger.debug(&quot;Attempting to Files to Temp Location&quot;)</div><div>    try:</div><div>        mytempdirectory = &quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot;</div><div>        logger.debug(mytempdirectory)</div><div>        logger.debug(fname)</div><div>        logger.debug(pname)</div><div>        # Check if dir exist and if not create</div><div>        if not os.path.exists(mytempdirectory):</div><div>            os.makedirs(mytempdirectory)</div><div>            time.sleep(10)</div><div>        shutil.os.remove(fname)  # Delete SharePoint Version</div><div>        logger.debug(&quot;File Deleted From Orign&quot;)</div><div>        time.sleep(30)</div><div>        # Replace Now Missing SharePoint with Copy from Temp File</div><div>        shutil.copy2(mytempdirectory + pname, excelpath)</div><div>        logger.debug(&quot;File Replaced&quot;)</div><div>    except Exception as e:</div><div>        logger.debug(e)</div><div><br/></div><div><br/></div><div>def locationoffiles(useranme):</div><div>    # Hardcode myptah variable#######################################################################################################################</div><div>    logger.debug('Getting Location of Files From Desktop txt file')</div><div>    orignpath = r&quot;C:\Users\%s&quot; % useranme + &quot;\Desktop\HourlyEmailFeeder*.txt&quot;</div><div>    for fname1 in glob.glob(orignpath):</div><div>        compiler1_df = pd.read_csv(fname1)</div><div>        listC1 = compiler1_df[&quot;LoctionofFile&quot;].drop_duplicates().values</div><div>    mypath = listC1[0]</div><div>    for fname in glob.glob(mypath):</div><div>        compiler_df = pd.read_csv(fname)</div><div>        your_listC1 = compiler_df['filequery'].tolist()</div><div>        your_listC2 = compiler_df['filepath'].tolist()</div><div>        if fname.find('Text') &gt;= 0:</div><div>            listTextPathsQuery = your_listC1</div><div>            listTextPaths = your_listC2</div><div>        elif fname.find('Excel') &gt;= 0:</div><div>            listexcelpathSearchsQuery = your_listC1</div><div>            listexcelpathSearchs = your_listC2</div><div>    txtpathSearch = listTextPaths[0] + listTextPathsQuery[0]</div><div>    excelpathSearch = listexcelpathSearchs[0] + listexcelpathSearchsQuery[0]</div><div>    excelpath = listexcelpathSearchs[0]</div><div>    return txtpathSearch, excelpathSearch, excelpath</div><div><br/></div><div><br/></div><div>def parameters_when_runfileDoWHour(txtpathSearch):</div><div>    logger.debug('Checking Parameter txt File')</div><div>    for filecount, fname in enumerate(glob.glob(txtpathSearch)):</div><div>        compiler_df = pd.read_csv(fname)</div><div>        filename_listC1 = compiler_df[&quot;filename&quot;].tolist()</div><div>    return filename_listC1, compiler_df</div><div><br/></div><div><br/></div><div>def SetFileLooping(filename_listC1, compiler_df, dayofweekinput, hourofdayinput, excelpathSearch, excelpath):</div><div>    # Starting Loop Through Iems</div><div>    for fname in glob.glob(excelpathSearch):</div><div>        pname = fname.replace(excelpath, &quot;&quot;)</div><div>        logger.debug('Compiling File Paramters - ' + pname)</div><div>        starthour = ''</div><div>        endhour = ''</div><div>        startday = ''</div><div>        endday = ''</div><div>        SheetToSend = ''</div><div>        Range1 = ''</div><div>        Range2 = ''</div><div>        Range3 = ''</div><div>        Range4 = ''</div><div>        EmailTo1 = ''</div><div>        EmailTo2 = ''</div><div>        AttachmentFlag = ''</div><div>        df = compiler_df</div><div>        starthour = df.loc[df['filename'] == pname, 'starthour'].item()</div><div>        endhour = df.loc[df['filename'] == pname, 'endhour'].item()</div><div>        startday = df.loc[df['filename'] == pname, 'startday'].item()</div><div>        endday = df.loc[df['filename'] == pname, 'endday'].item()</div><div>        SheetToSend = df.loc[df['filename'] == pname, 'SheetToSend'].item()</div><div>        Range1 = df.loc[df['filename'] == pname, 'Range1'].item()</div><div>        Range2 = df.loc[df['filename'] == pname, 'Range2'].item()</div><div>        Range3 = df.loc[df['filename'] == pname, 'Range3'].item()</div><div>        Range4 = df.loc[df['filename'] == pname, 'Range4'].item()</div><div>        EmailTo1 = df.loc[df['filename'] == pname, 'EmailTo1'].item()</div><div>        EmailTo2 = df.loc[df['filename'] == pname, 'EmailTo2'].item()</div><div>        AttachmentFlag = df.loc[df['filename']</div><div>                                == pname, 'AttachmentFlag'].item()</div><div>        if any(pname in s for s in filename_listC1):</div><div>            mycount = 0</div><div>            start_time = datetime.now()</div><div>            logger.debug(</div><div>                &quot;StartTime - &quot; +</div><div>                fname.replace(excelpath, &quot;&quot;))</div><div>            logger.debug('Dow and Hour Checker Section - ' + pname)</div><div>            if (dayofweekinput &gt;= startday and dayofweekinput &lt;= endday) and (hourofdayinput &gt;= starthour and hourofdayinput &lt;= endhour):</div><div>                attemptToOpenSpreadSheet(</div><div>                    pname=pname, start_time=start_time, fname=fname,</div><div>                    path=excelpathSearch, mycount=mycount,</div><div>                    Range1=Range1, Range2=Range2, Range3=Range3, Range4=Range4,</div><div>                    SheetToSend=SheetToSend, EmailTo1=EmailTo1, EmailTo2=EmailTo2,</div><div>                    AttachmentFlag=AttachmentFlag</div><div>                )</div><div>            else:</div><div>                logger.debug('Not Ran as outside of HOOPS - ' + pname)</div><div>        else:</div><div>            logger.debug(pname + '- File Not in List')</div><div><br/></div><div><br/></div><div>def attemptToOpenSpreadSheet(AttachmentFlag, pname, start_time, fname, path, mycount, Range1, Range2, Range3, Range4, SheetToSend, EmailTo1, EmailTo2):</div><div>    try:</div><div>        savetempfileondesktop(fname=fname, path=path, pname=pname)</div><div>        logger.debug(&quot;Opening SpreadSheet - &quot; + pname)</div><div>        errorindicator_one = &quot;, No Error&quot;</div><div>        Application = win32com.client.Dispatch(&quot;Excel.Application&quot;)</div><div>        time.sleep(5)</div><div>        Application.Visible = True</div><div>        Application.DisplayAlerts = False</div><div>        Application.AskToUpdateLinks = False</div><div>        wb = Application.Workbooks.Open(r&quot;\\&quot; + fname)</div><div>        logger.debug(&quot;Refreshing SpreadSheet - &quot; + pname)</div><div>        wb.RefreshAll()</div><div>        time.sleep(5)</div><div>        logger.debug(&quot;Saving SpreadSheet - &quot; + pname)</div><div>        wb.SaveAs(r&quot;\\&quot; + fname)</div><div>        time.sleep(2)</div><div>        # ################  Save ScreenShot on Dekstop ###################</div><div>        logger.debug(&quot;Creating Temp SpreadSheet For ScreenShot - &quot; + pname)</div><div>        r = wb.Sheets(SheetToSend)</div><div>        r.Range(r.Cells(Range1, Range2), r.Cells(Range3, Range4)).CopyPicture()</div><div>        time.sleep(2)</div><div>        temp_sheet = Application.Worksheets.Add()</div><div>        logger.debug('Sheet for  ScreeeShot Added - ' + pname)</div><div>        temp_sheet.Paste()</div><div>        logger.debug('Pasted ScreeeShot - ' + pname)</div><div>        time.sleep(1)</div><div>        temp_sheet.Shapes('Picture 1').Copy()</div><div>        img = ImageGrab.grabclipboard()</div><div>        img.save(&quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot; +</div><div>                 pname.replace('.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;) + &quot;.png&quot;, 'PNG')</div><div>        time.sleep(1)</div><div>        temp_sheet.Delete()</div><div>        time.sleep(1)</div><div>        logger.debug('Saved ScreeeShot - ' + pname)</div><div>        # Old</div><div>        # wb1 = Application.Workbooks.Add()</div><div>        # ws = wb1.ActiveSheet</div><div>        # ws.Paste()</div><div>        # ws.Shapes('Picture 1').Copy()</div><div>        # img = ImageGrab.grabclipboard()</div><div>        # img.save(&quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot; + pname.replace('.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;) + &quot;.png&quot;, 'PNG')</div><div>        logger.debug('Comleted ScreenShot - ' + pname)</div><div>        time.sleep(1)</div><div>        # wb1.Close()</div><div>        time.sleep(2)</div><div>        wb.Close()</div><div>        time.sleep(5)</div><div>        Application.Quit()</div><div>        logger.debug(</div><div>            &quot;EndTime - &quot;</div><div>            + fname.replace(excelpath, &quot;&quot;))</div><div>        end_time = datetime.now()</div><div>        CreateEmail(pname=pname, EmailTo1=EmailTo1, EmailTo2=EmailTo2,</div><div>                    AttachmentFlag=AttachmentFlag, attachment1=fname)</div><div>    except IOError:</div><div>        close_excel_by_force(Application)</div><div>        errorindicator_one = &quot;, Failed Open Error&quot;</div><div>        logger.debug(&quot;cannot open&quot;)</div><div>    except com_error as e:</div><div>        errorindicator_one = &quot;;Data Fail Error&quot;</div><div>        logger.debug(</div><div>            'Server Exception Thrown,  That Frown Face Though : ' + fname)</div><div>        logger.debug(e)</div><div>        close_excel_by_force(Application)</div><div>        mycountchecker(</div><div>            AttachmentFlag=AttachmentFlag, pname=pname, start_time=start_time, fname=fname, path=path,</div><div>            mycount=mycount, Range1=Range1, Range2=Range2, Range3=Range3,</div><div>            Range4=Range4, SheetToSend=SheetToSend, EmailTo1=EmailTo1, EmailTo2=EmailTo2, excelpath=excelpath</div><div>        )</div><div>    except Exception as e:</div><div>        close_excel_by_force(Application)</div><div>        errorindicator_one = &quot;, Other Open Error&quot;</div><div>        logger.debug(&quot;Other Exception on file :&quot; + str(e))</div><div>    else:</div><div>        pass</div><div>    finally:</div><div>        end_time = datetime.now()</div><div>        totaltime = end_time - start_time</div><div>        logger.debug(</div><div>            &quot;Completed, &quot; +</div><div>            fname.replace(excelpath, &quot;&quot;)</div><div>            + &quot;, &quot; + str(totaltime.seconds) + &quot;Seconds&quot; + errorindicator_one)</div><div>        close_excel_by_force(Application)</div><div><br/></div><div><br/></div><div>def CreateEmail(pname, EmailTo1, EmailTo2, attachment1, AttachmentFlag):</div><div>    logger.debug(&quot;Starting Email Generation, &quot; + pname)</div><div>    o = win32com.client.gencache.EnsureDispatch(&quot;Outlook.Application&quot;)</div><div>    nmail = o.CreateItem(0)</div><div>    attachment = nmail.Attachments.Add(&quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot; + pname.replace(</div><div>        '.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;) + &quot;.png&quot;, win32com.client.constants.olEmbeddeditem, 0, pname)</div><div>    imageCid = pname + &quot;.png&quot;</div><div>    attachment.PropertyAccessor.SetProperty(</div><div>        &quot;http://schemas.microsoft.com/mapi/proptag/0x3712001E&quot;,  imageCid)</div><div>    nmail.HTMLBody = &quot;&lt;body&gt;&lt;img src=\&quot;cid:{0}\&quot;&gt;&lt;/body&gt;&quot;.format(imageCid)</div><div>    nmail.To = EmailTo1</div><div>    # mysubject = pname.replace('.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;).replace('_', ' ') + ' Report'</div><div>    if 'Hourly' in pname:</div><div>        d = datetime.today().strftime('%m-%d ') + datetime.today().strftime('@%I%p')</div><div>        mysubject = pname.replace('.xlsx', &quot;&quot;).replace(</div><div>            '.xlsb', &quot;&quot;).replace('_', ' ') + ' Report - ' + d</div><div>    else:</div><div>        d = datetime.today() - timedelta(days=1)</div><div>        d = d.strftime('%m-%d')</div><div>        print(d)</div><div>        mysubject = pname.replace('.xlsx', &quot;&quot;).replace(</div><div>            '.xlsb', &quot;&quot;).replace('_', ' ') + ' Report - ' + d</div><div>        print(mysubject)</div><div>    mysubject = mysubject.replace(&quot;  &quot;, &quot; &quot;)</div><div>    nmail.Subject = mysubject</div><div>    if AttachmentFlag == 'y':</div><div>        nmail.Attachments.Add(Source=attachment1)</div><div>        nmail.Attachments.Add(Source=&quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot; +</div><div>                              pname.replace('.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;) + &quot;.png&quot;)</div><div>    else:</div><div>        nmail.Attachments.Add(Source=&quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot; +</div><div>                              pname.replace('.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;) + &quot;.png&quot;)</div><div>    nmail.SentOnBehalfOfName = &quot;RS.Department@company.com&quot;</div><div>    nmail.Send()</div><div>    logger.debug(&quot;EmailGenerated, &quot; + pname)</div><div>    if type(EmailTo2) != float:</div><div>        # Email Generation</div><div>        o = win32com.client.gencache.EnsureDispatch(&quot;Outlook.Application&quot;)</div><div>        nmail = o.CreateItem(0)</div><div>        attachment = nmail.Attachments.Add(&quot;C:\\Users\\&quot; + useranme + &quot;\\Desktop\\&quot; + pname.replace(</div><div>            '.xlsx', &quot;&quot;).replace('.xlsb', &quot;&quot;) + &quot;.png&quot;, win32com.client.constants.olEmbeddeditem, 0, pname)</div><div>        imageCid = pname + &quot;.png&quot;</div><div>        attachment.PropertyAccessor.SetProperty(</div><div>            &quot;http://schemas.microsoft.com/mapi/proptag/0x3712001E&quot;,  imageCid)</div><div>        nmail.HTMLBody = &quot;&lt;body&gt;&lt;head&gt;&lt;style&gt;img{max-width: 100%;}&lt;/style&gt;&lt;/head&gt;&lt;img src=\&quot;cid:{0}\&quot;&gt;&lt;/body&gt;&quot;.format(</div><div>            imageCid)</div><div>        nmail.To = EmailTo2</div><div>        d = datetime.today().strftime('%m-%d ') + datetime.today().strftime('@%I%p')</div><div>        mysubject = pname.replace('.xlsx', &quot;&quot;).replace(</div><div>            '.xlsb', &quot;&quot;).replace('_', ' ') + ' Report'</div><div>        if 'Hourly' in pname:</div><div>            mysubject = pname.replace('.xlsx', &quot;&quot;).replace(</div><div>                '.xlsb', &quot;&quot;).replace('_', ' ') + ' Report - ' + d</div><div>        else:</div><div>            d = datetime.today() - timedelta(days=1)</div><div>            d = d.strftime('%m-%d')</div><div>            print(d)</div><div>            mysubject = pname.replace('.xlsx', &quot;&quot;).replace(</div><div>                '.xlsb', &quot;&quot;).replace('_', ' ') + ' Report - ' + d</div><div>            print(mysubject)</div><div>        mysubject = mysubject.replace(&quot;  &quot;, &quot; &quot;)</div><div>        nmail.Subject = mysubject</div><div>        if AttachmentFlag == 'y':</div><div>            nmail.Attachments.Add(Source=attachment1)</div><div>        else:</div><div>            pass</div><div>        nmail.Subject = pname.replace('.xlsx', &quot;&quot;).replace(</div><div>            '.xlsb', &quot;&quot;).replace('_', ' ') + ' Report'</div><div>        nmail.SentOnBehalfOfName = &quot;rs.Department@company.com&quot;</div><div>        nmail.Send()</div><div>        logger.debug(&quot;EmailGenerated2, &quot; + pname)</div><div>    else:</div><div>        logger.debug(&quot;No Secondary Email for - , &quot; + pname)</div><div><br/></div><div><br/></div><div>def EndProgram(self):</div><div>    if __name__ == __name__:</div><div>        logger.debug(&quot;Program Complete&quot;)</div><div>        pr_end_time = datetime.now()</div><div>        prtotaltime = pr_end_time - pr_start_time</div><div>        logger.debug(&quot;Completed In : &quot; + str(prtotaltime.seconds) + &quot; Seconds&quot;)</div><div><br/></div><div><br/></div><div>if __name__ == __name__:</div><div>    useranme = getpass.getuser()  # Captures Useranme</div><div><br/></div><div>    logger = logging.getLogger(__name__)</div><div>    logger.setLevel(logging.DEBUG)</div><div>    formatter = logging.Formatter(' %(message)s - %(asctime)s ')</div><div><br/></div><div>    file_handler = RotatingFileHandler(</div><div>        &quot;C:\\Users\\&quot; + useranme + &quot;\Desktop\Debuglog.txt&quot;, maxBytes=50000, backupCount=5)  # Sets LogFileLocation</div><div>    file_handler.setLevel(logging.DEBUG)</div><div>    file_handler.setFormatter(formatter)</div><div><br/></div><div>    stream_handler = logging.StreamHandler()</div><div>    stream_handler.setLevel(logging.DEBUG)</div><div>    stream_handler.setFormatter(formatter)</div><div><br/></div><div>    logger.addHandler(file_handler)</div><div>    logger.addHandler(stream_handler)</div><div><br/></div><div>    pr_start_time = datetime.now()</div><div>    dayofweekinput = datetime.today().weekday()</div><div>    hourofdayinput = datetime.now().hour</div><div>    txtpathSearch, excelpathSearch, excelpath = locationoffiles(useranme)</div><div>    filename_listC1, compiler_df = parameters_when_runfileDoWHour(</div><div>        txtpathSearch)</div><div>    SetFileLooping(filename_listC1, compiler_df, dayofweekinput,</div><div>                   hourofdayinput, excelpathSearch, excelpath)</div><div>    EndProgram(__name__)</div></div><div><br/></div><div>There are four feeder .txt files. </div><ol><li><div> Desktop File </div></li><ul><li><div>LocationofFile - Header</div></li><li><div>\\sitebuilder\dawwwroot\rootsite\subsite\Documents\Folder\*_config_FileLocations*.txt</div></li></ul><li><div>_Config_FileLocations</div></li><ul><li><div>filequery, filepath - Header(s)</div></li><li><div>*_config_DOWandHour*.txt, \\sitebuilder\dawwwroot\rootsite\subsite\Documents\Folder\</div></li></ul><li><div>_Config_FileLocationsExcel</div></li><ul><li><div>filequery,filepath</div></li><li><div>*.xls*,\\sitebuilder\dawwwroot\rootsite\subsite\Documents\Folder\</div></li></ul><li><div>_HourlyReports_config_DOWandHour</div></li><ol><li><div>filename,attachmentflag,starthour,endhour,startday,endday,SheetToSend,Range1,Range2,Range3,Range4,EmailTo1,EmailTo2 -Header(s)</div></li><li><div>Daily_FileName.xlsx,y,0,23,0,6,Email,1,4,92,89,Email@company.com</div></li></ol></ol><div><br/></div></div></span>
</div></body></html>
