---
categories: [Python]
---
<html>
<head>
  <title>Combine CSV</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307881 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="454"/>

<div>
<span><div><div><b>Problem: </b></div><div><b>   </b> <font style="font-size: 8pt;">Combine x number of CSV files. Each file has a header and second row of &quot;-----&quot; as a place holder. </font><br/></div><div><b><br/></b></div><div><b>Solution:</b></div><div><b>   </b> <font style="font-size: 8pt;">A python Script to iterate over the files. </font></div><div><font style="font-size: 8pt;"><br/></font></div><hr/><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>import glob</div><div>import csv</div><div>import codecs</div><div><br/></div><div>rowcounter = 0</div><div># import csv files from folder</div><div>path = r'\\ent.core.company.com\mit-city01\City Public\Folder\Folder'</div><div>allFiles = glob.glob(path + &quot;/*.csv&quot;)</div><div>with open(r'\\ent.core.company.com\mit-city01\City Public\Folder\combined.csv', 'wt') as outfile:</div><div>    writer = csv.writer(outfile)</div><div>    for i, fname in enumerate(allFiles):</div><div>        indirowcount = 0</div><div>        csv_f = csv.reader(x.replace('\0', '')</div><div>                           for x in codecs.open(fname, 'rU', 'utf-16'))</div><div>        print(fname.replace(</div><div>            r'\\ent.core.company.com\mit-city01\City Public\Folder\Folder', ''), 'file:' + str(i))</div><div>        if i != 0:</div><div>            for x, row in enumerate(csv_f):</div><div>                if x &gt; 1:</div><div>                    writer.writerow(row)</div><div>                    rowcounter = rowcounter + 1</div><div>                    indirowcount = indirowcount + 1</div><div>                elif x == 0:</div><div>                    print('Skipped Header Row')</div><div>                elif x == 1:</div><div>                    print('Skipped First Row')</div><div>        else:</div><div>            for x, row in enumerate(csv_f):</div><div>                if x != 1:</div><div>                    writer.writerow(row)</div><div>                    indirowcount = indirowcount + 1</div><div>                    rowcounter = rowcounter + 1</div><div>                elif x == 1:</div><div>                    print('Skipped First Row')</div><div>        print('rows ' + str(indirowcount) + ' of ' +</div><div>              str(x + 1), 'Total Rows ' + str(rowcounter))</div><div><br/></div></div><div><br/></div></div></span>
</div></body></html>
